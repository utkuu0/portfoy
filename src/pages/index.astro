---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";

import ProjectCard from "../components/ProjectCard.astro";
import SkillBar from "../components/SkillBar.astro";
import Footer from "../components/Footer.astro";

// Import translations
import { translations } from "../i18n/translations";

const navLinks = [
  { href: "#hakkimda", label: "Hakkımda", key: "about" },
  { href: "#projeler", label: "Projeler", key: "projects" },
  { href: "#yetenekler", label: "Yetenekler", key: "skills" },
  { href: "#iletisim", label: "İletişim", key: "contact" },
];

const projects = [
  {
    title: "TechNews",
    description:
      "Modern Android teknoloji haberleri uygulaması. Jetpack Compose UI, Clean Architecture, MVVM pattern, Room ile offline destek, WorkManager ile günlük bildirimler, karanlık mod ve pull-to-refresh özellikleri.",
    tags: ["Kotlin", "Jetpack Compose", "MVVM", "Room", "Hilt"],
    github: "https://github.com/utkuu0/newsApp",
    image: "/projects/technews.png",
  },
  {
    title: "FinanssHub",
    description:
      "Anlık döviz kurlarını takip edebileceğiniz Android uygulaması. API entegrasyonu ile güncel kur bilgileri, temiz ve kullanıcı dostu arayüz tasarımı.",
    tags: ["Kotlin", "Android", "API"],
    github: "https://github.com/utkuu0/FinanssHub",
    image: "/projects/finansshub.png",
  },
  {
    title: "Portföy",
    description:
      "Astro framework ile geliştirilmiş kişisel portföy sitesi. Türkçe/İngilizce çoklu dil desteği, responsive tasarım, SEO optimizasyonu ve modern glassmorphism UI.",
    tags: ["Astro", "TypeScript", "CSS"],
    github: "https://github.com/utkuu0/portfoy",
    image: "/projects/portfoy.png",
  },
];

const skills = [
  { name: "Kotlin", icon: "/icons/kotlin.svg", level: 85 },
  { name: "React Native", icon: "/icons/react.svg", level: 55 },
  { name: "Python", icon: "/icons/python.svg", level: 70 },
  { name: "Git / GitHub", icon: "/icons/github.svg", level: 65 },
  { name: "Ruby", icon: "/icons/ruby.png", level: 35 },
];
---

<Layout title="Utku | Full Stack Developer">
  <Header links={navLinks} />

  <main>
    <!-- Hero Section - Photo Left, Intro Right -->
    <section id="hero" class="min-h-screen flex items-center px-6 pt-24">
      <div class="max-w-6xl mx-auto w-full">
        <div class="grid md:grid-cols-2 gap-12 items-center">
          <!-- Photo Left -->
          <div class="relative order-2 md:order-1">
            <div
              class="w-72 h-72 md:w-96 md:h-96 mx-auto rounded-3xl bg-gradient-to-br from-slate-400 to-slate-600 p-1"
            >
              <img
                src="/profile.jpg"
                alt="Utku"
                class="w-full h-full rounded-3xl object-cover object-top"
              />
            </div>
          </div>

          <!-- Intro Right -->
          <div class="order-1 md:order-2 text-center md:text-left">
            <h1 class="text-4xl md:text-6xl font-bold mb-4 leading-tight">
              <span data-i18n="hero.greeting">Merhaba, ben</span>
              <span class="gradient-text">Utku</span>
            </h1>
            <p
              class="text-xl md:text-2xl text-slate-300 font-medium mb-4"
              data-i18n="hero.role"
            >
              Full Stack & Mobile Developer
            </p>
            <p
              class="text-lg text-slate-400 leading-relaxed"
              data-i18n="hero.description"
            >
              Modern web ve mobil uygulamalar geliştiriyorum. Kullanıcı deneyimi
              odaklı, performanslı ve ölçeklenebilir çözümler sunuyorum.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section id="hakkimda" class="py-24 px-6">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-bold mb-8 text-center">
          <span class="gradient-text" data-i18n="about.title">Hakkımda</span>
        </h2>
        <p
          class="text-slate-300 text-lg leading-relaxed mb-6 text-center"
          data-i18n="about.p1"
        >
          Yazılım geliştirme tutkusuyla dolu bir geliştiriciyim. Android
          uygulamalarından web projelerine kadar geniş bir yelpazede
          çalışıyorum.
        </p>
        <p
          class="text-slate-400 leading-relaxed mb-10 text-center"
          data-i18n="about.p2"
        >
          Modern teknolojileri kullanarak kullanıcı dostu ve performanslı
          uygulamalar geliştirmeyi seviyorum. Sürekli öğrenme ve kendimi
          geliştirme konusunda tutkuluyum.
        </p>

        <!-- Stats -->
        <div class="grid grid-cols-2 gap-4 max-w-md mx-auto">
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-3xl font-bold gradient-text mb-1">2+</div>
            <div
              class="text-xs text-slate-500 uppercase tracking-widest"
              data-i18n="about.stats.experience"
            >
              Yıl Deneyim
            </div>
          </div>
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-3xl font-bold gradient-text mb-1">5+</div>
            <div
              class="text-xs text-slate-500 uppercase tracking-widest"
              data-i18n="about.stats.projects"
            >
              Proje
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Projects Section -->
    <section id="projeler" class="py-24 px-6">
      <div class="max-w-6xl mx-auto">
        <div class="text-center mb-16">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">
            <span class="gradient-text" data-i18n="projects.title"
              >Projeler</span
            >
          </h2>
          <p
            class="text-slate-400 max-w-2xl mx-auto"
            data-i18n="projects.subtitle"
          >
            Üzerinde çalıştığım ve geliştirdiğim projelerden bazıları
          </p>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
          {projects.map((project) => <ProjectCard {...project} />)}
        </div>
      </div>
    </section>

    <!-- Skills Section -->
    <section id="yetenekler" class="py-24 px-6">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-16">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">
            <span class="gradient-text" data-i18n="skills.title"
              >Yetenekler</span
            >
          </h2>
          <p
            class="text-slate-400 max-w-2xl mx-auto"
            data-i18n="skills.subtitle"
          >
            Kullandığım teknolojiler ve araçlar
          </p>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
          {skills.map((skill) => <SkillBar {...skill} />)}
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section id="iletisim" class="py-24 px-4 md:px-6">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">
          <span class="gradient-text" data-i18n="contact.title"
            >İletişime Geçin</span
          >
        </h2>
        <p
          class="text-slate-400 mb-12 max-w-xl mx-auto px-2"
          data-i18n="contact.subtitle"
        >
          Bir proje fikriniz mi var? Birlikte çalışmak ister misiniz? Bana
          ulaşın!
        </p>

        <div class="glass rounded-2xl p-4 sm:p-6 md:p-12">
          <form id="contact-form" class="space-y-4 md:space-y-6 w-full">
            <input
              type="text"
              id="contact-name"
              required
              placeholder="Adınız"
              data-i18n-placeholder="contact.form.name"
              class="w-full px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border border-white/10 rounded-xl text-white placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors"
              style="max-width: 100%;"
            />
            <input
              type="email"
              id="contact-email"
              required
              placeholder="E-posta adresiniz"
              data-i18n-placeholder="contact.form.email"
              class="w-full px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border border-white/10 rounded-xl text-white placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors"
              style="max-width: 100%;"
            />
            <input
              type="text"
              id="contact-subject"
              required
              placeholder="Konu"
              data-i18n-placeholder="contact.form.subject"
              class="w-full px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border border-white/10 rounded-xl text-white placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors"
              style="max-width: 100%;"
            />
            <textarea
              rows="5"
              id="contact-message"
              required
              placeholder="Mesajınız..."
              data-i18n-placeholder="contact.form.message"
              class="w-full px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border border-white/10 rounded-xl text-white placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors resize-none"
              style="max-width: 100%;"></textarea>
            <button
              type="submit"
              class="w-full md:w-auto px-8 py-4 bg-gradient-to-r from-slate-200 to-slate-400 rounded-xl text-slate-900 font-semibold hover:shadow-xl hover:shadow-white/20 transition-all duration-300 hover:scale-105"
            >
              <span data-i18n="contact.form.submit">Mesaj Gönder</span>
            </button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <!-- Contact Form Formspree Handler -->
  <script>
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const submitBtn = form?.querySelector(
      'button[type="submit"]',
    ) as HTMLButtonElement;
    const submitText = submitBtn?.querySelector("span");

    form?.addEventListener("submit", async function (e) {
      e.preventDefault();

      if (submitBtn) submitBtn.disabled = true;
      if (submitText) submitText.textContent = "Gönderiliyor...";

      const name = (document.getElementById("contact-name") as HTMLInputElement)
        .value;
      const email = (
        document.getElementById("contact-email") as HTMLInputElement
      ).value;
      const subject = (
        document.getElementById("contact-subject") as HTMLInputElement
      ).value;
      const message = (
        document.getElementById("contact-message") as HTMLTextAreaElement
      ).value;

      try {
        const response = await fetch("https://formspree.io/f/mkogwkvr", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify({
            name: name,
            email: email,
            _subject: subject,
            message: message,
          }),
        });

        if (response.ok) {
          if (submitText) submitText.textContent = "Gönderildi! ✓";
          form.reset();

          setTimeout(() => {
            if (submitText) submitText.textContent = "Mesaj Gönder";
            if (submitBtn) submitBtn.disabled = false;
          }, 3000);
        } else {
          throw new Error("Form submission failed");
        }
      } catch (error) {
        console.error("Form Error:", error);
        if (submitText) submitText.textContent = "Hata! Tekrar deneyin";
        if (submitBtn) submitBtn.disabled = false;

        setTimeout(() => {
          if (submitText) submitText.textContent = "Mesaj Gönder";
        }, 3000);
      }
    });
  </script>

  <!-- Floating Contact Button -->
  <button
    id="contact-fab"
    class="fixed bottom-6 right-6 z-50 w-14 h-14 bg-gradient-to-r from-slate-200 to-slate-400 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-all duration-300 hover:shadow-white/30"
    aria-label="İletişime geç"
  >
    <svg
      class="w-6 h-6 text-slate-900"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
      ></path>
    </svg>
  </button>

  <!-- Contact Modal -->
  <div id="contact-modal" class="fixed inset-0 z-[60] hidden">
    <!-- Backdrop -->
    <div
      id="modal-backdrop"
      class="absolute inset-0 bg-black/60 backdrop-blur-sm"
    >
    </div>

    <!-- Modal Content -->
    <div
      class="absolute bottom-24 right-6 w-80 max-w-[calc(100vw-3rem)] transform transition-all duration-300 scale-95 opacity-0"
      id="modal-content"
    >
      <div
        class="glass rounded-2xl p-6 border border-white/20 shadow-2xl overflow-hidden"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-white">Hızlı Mesaj</h3>
          <button
            id="close-modal"
            class="text-slate-400 hover:text-white transition-colors"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <form id="quick-contact-form" class="space-y-3">
          <input
            type="text"
            name="name"
            required
            placeholder="Adınız"
            class="w-full px-4 py-3 bg-slate-800/50 border border-white/10 rounded-xl text-white text-sm placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors"
            style="box-sizing: border-box;"
          />
          <input
            type="email"
            name="email"
            required
            placeholder="E-posta"
            class="w-full px-4 py-3 bg-slate-800/50 border border-white/10 rounded-xl text-white text-sm placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors"
            style="box-sizing: border-box;"
          />
          <textarea
            name="message"
            required
            rows="3"
            placeholder="Mesajınız..."
            class="w-full px-4 py-3 bg-slate-800/50 border border-white/10 rounded-xl text-white text-sm placeholder:text-slate-500 focus:outline-none focus:border-slate-400 transition-colors resize-none"
            style="box-sizing: border-box;"></textarea>
          <button
            type="submit"
            id="quick-submit-btn"
            class="w-full py-3 bg-gradient-to-r from-slate-200 to-slate-400 rounded-xl text-slate-900 font-semibold text-sm hover:shadow-lg hover:shadow-white/20 transition-all duration-300"
          >
            Gönder
          </button>
        </form>

        <div class="mt-4 pt-4 border-t border-white/10">
          <p class="text-xs text-slate-500 text-center mb-2">
            veya direkt ulaşın
          </p>
          <div class="flex justify-center gap-3">
            <a
              href="https://wa.me/905050988422"
              target="_blank"
              class="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center hover:bg-green-500/40 transition-colors"
            >
              <svg
                class="w-5 h-5 text-green-400"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"
                ></path>
              </svg>
            </a>
            <a
              href="mailto:muhammedutkuaksu1@gmail.com"
              class="w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center hover:bg-blue-500/40 transition-colors"
            >
              <svg
                class="w-5 h-5 text-blue-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                ></path>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Script -->
  <script>
    const fab = document.getElementById("contact-fab");
    const modal = document.getElementById("contact-modal");
    const modalContent = document.getElementById("modal-content");
    const backdrop = document.getElementById("modal-backdrop");
    const closeBtn = document.getElementById("close-modal");
    const quickForm = document.getElementById(
      "quick-contact-form",
    ) as HTMLFormElement;
    const quickSubmitBtn = document.getElementById("quick-submit-btn");

    function openModal() {
      modal?.classList.remove("hidden");
      setTimeout(() => {
        modalContent?.classList.remove("scale-95", "opacity-0");
        modalContent?.classList.add("scale-100", "opacity-100");
      }, 10);
    }

    function closeModal() {
      modalContent?.classList.remove("scale-100", "opacity-100");
      modalContent?.classList.add("scale-95", "opacity-0");
      setTimeout(() => {
        modal?.classList.add("hidden");
      }, 300);
    }

    fab?.addEventListener("click", openModal);
    closeBtn?.addEventListener("click", closeModal);
    backdrop?.addEventListener("click", closeModal);

    // Quick form submission
    quickForm?.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (quickSubmitBtn) quickSubmitBtn.textContent = "Gönderiliyor...";

      const formData = new FormData(quickForm);
      try {
        const response = await fetch("https://formspree.io/f/mkogwkvr", {
          method: "POST",
          headers: { Accept: "application/json" },
          body: formData,
        });

        if (response.ok) {
          if (quickSubmitBtn) quickSubmitBtn.textContent = "Gönderildi! ✓";
          quickForm.reset();
          setTimeout(() => {
            closeModal();
            if (quickSubmitBtn) quickSubmitBtn.textContent = "Gönder";
          }, 2000);
        } else {
          throw new Error("Failed");
        }
      } catch (error) {
        if (quickSubmitBtn) quickSubmitBtn.textContent = "Hata! Tekrar deneyin";
        setTimeout(() => {
          if (quickSubmitBtn) quickSubmitBtn.textContent = "Gönder";
        }, 2000);
      }
    });
  </script>

  <Footer />
</Layout>

<script define:vars={{ translations }}>
  // Language switching logic
  function updateLanguage(lang) {
    console.log("Switching to", lang);
    const data = translations[lang];
    if (!data) return;

    // Update text content
    document.querySelectorAll("[data-i18n]").forEach((el) => {
      const key = el.getAttribute("data-i18n");
      const keys = key.split(".");
      let value = data;

      for (const k of keys) {
        value = value ? value[k] : null;
      }

      if (value) el.textContent = value;
    });

    // Update placeholders
    document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
      const key = el.getAttribute("data-i18n-placeholder");
      const keys = key.split(".");
      let value = data;

      for (const k of keys) {
        value = value ? value[k] : null;
      }

      if (value) el.placeholder = value;
    });

    // Update header language display
    const currentLangSpan = document.getElementById("current-lang");
    const currentLangIcon = document.getElementById("current-lang-icon");

    if (currentLangSpan) currentLangSpan.textContent = lang.toUpperCase();
    if (currentLangIcon) {
      currentLangIcon.src = lang === "tr" ? "/flags/tr.svg" : "/flags/en.svg";
    }

    // Hide current language from dropdown
    document.querySelectorAll(".lang-option").forEach((option) => {
      const optionLang = option.getAttribute("data-lang");
      if (optionLang === lang) {
        option.style.display = "none";
      } else {
        option.style.display = "flex";
      }
    });

    // Save preference
    localStorage.setItem("language", lang);
  }

  // Listen for language changes from Header
  document.addEventListener("click", (e) => {
    const btn = e.target.closest(".lang-option");
    if (btn) {
      const lang = btn.getAttribute("data-lang");
      updateLanguage(lang);
    }
  });

  // Initialize
  document.addEventListener("DOMContentLoaded", () => {
    const savedLang = localStorage.getItem("language") || "tr";
    updateLanguage(savedLang);
  });
</script>
